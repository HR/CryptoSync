<!doctype html>
<html>

<head>
	<meta charset="utf-8">
	<title>Crypto.Sync</title>
	<link rel="stylesheet" href="style/menubar.css">
</head>

<body>
	<!-- CS Menubar v1f -->
	<section id="menubar">
		<div class="head">
			<a class="left navigationLink" data-target="openSyncFolder" id="openSyncFolder">
				<img class="icon" src="images/icons/folder.svg" alt="" />
			</a>
			<a class="right navigationLink" data-target="openVault">
				<img class="icon" src="images/icons/CryptoSyncVault_sl.svg" alt="" />
			</a>
		</div>
		<header>RECENTLY CHANGED</header>
		<div class="fileList" id="filesList">
		</div>
		<footer>
			<div class="status">
				<img class="icon left" src="images/icons/status/synced.svg" />
				<span>Synced</span>
			</div>
			<a class="right navigationLink" data-target="openSettings">
				<img class="icon" src="images/icons/settings.svg" />
			</a>
			<a class="left navigationLink" data-target="quitApp">
				<img class="icon" src="images/icons/quit.svg" alt="" />
			</a>
		</footer>
	</section>
	<script id="file-template" type="text/x-handlebars-template">
		<div class="item">
			<div class="type">
				<img class="fileType" src="images/icons/filetypes/{{fileType}}.svg">
				<div class="cloudType">
					<img src="images/icons/{{type}}.svg"></img>
				</div>
			</div>
			<div class="content">
				<div class="name">{{name}}</div>
				<div class="lastMod">{{lastMod}}</div>
			</div>
		</div>
	</script>
	<script type="text/javascript">
		window.$ = window.jQuery = require('jquery');
		// load core modules first
		var remote = require('electron').remote,
			gAuth = remote.getGlobal('gAuth'),
			ipcRenderer = require('electron').ipcRenderer,
			remoteWin = remote.getCurrentWindow(),
			paths = remote.getGlobal("paths"),
			views = remote.getGlobal("views"),
			mdb = remote.getGlobal("mdb"),
			rconsole = remote.getGlobal("console"),
			webContents = remoteWin.webContents;

		/* Network change event */
		function updateOnlineStatus() {
			ipcRenderer.send('online-status-changed', navigator.onLine ? 'online' : 'offline');
		};
		$(window).on('online', updateOnlineStatus);
		$(window).on('offline', updateOnlineStatus);
		updateOnlineStatus();
		$(window).load(function() {
			// attach click listners
			$(".navigationLink").each(function(index) {
				$(this).click(function() {
					if (this.hasAttribute("data-target")) emittEvent(this.getAttribute("data-target"));
				});
			});
		});

		function addFiles(files) {
			for (var file in files) {
				if (files.hasOwnProperty(file)) {
					var template = Handlebars.compile($("#file-template").html());
					var file = template(files[file]);
					$('#filesList').append(file);
				}
			}
		}

		function emittEvent(event) {
			// send event to main
			rconsole.log("RENDER: " + event + " event emitted");
			ipcRenderer.send(event);
		}
	</script>
</body>

</html>
